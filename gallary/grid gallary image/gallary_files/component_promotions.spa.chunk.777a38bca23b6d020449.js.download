(window.webpackJsonp=window.webpackJsonp||[]).push([["component_promotions"],{"./node_modules/@plasma-platform/helpers/lib/others/dispatchCustomEvent.js":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,n){try{var t=new CustomEvent(e,{detail:n});return document.dispatchEvent(t)}catch(e){return!1}}},"./src/shared/components/Promotions/Promotions.jsx":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(t("./node_modules/react/index.js")),r=(l(t("./node_modules/prop-types/index.js")),t("./node_modules/@plasma-platform/promotions/lib/promotions.js")),a=l(r),i=l(t("./config/app/production.js")),u=t("./src/shared/utils/index.js"),s=l(t("./node_modules/@plasma-platform/helpers/lib/others/dispatchCustomEvent.js"));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,n,t,o,r,a,i){try{var u=e[a](i),s=u.value}catch(e){return void t(e)}u.done?n(s):Promise.resolve(s).then(o,r)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var a=e.apply(n,t);function i(e){c(a,o,r,i,u,"next",e)}function u(e){c(a,o,r,i,u,"throw",e)}i(void 0)}))}}function m(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,n){return(v=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function h(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var b=o.default.createElement,y=o.default.PureComponent,P=o.default.Fragment,g=function(e){function n(e){var t,o,a;if(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),o=this,a=p(n).call(this,e),t=!a||"object"!=typeof a&&"function"!=typeof a?f(o):a,h(f(t),"initJsUrl",i.default.revive.url),h(f(t),"bannerZones",[]),h(f(t),"bannerAttributes",{membershipStatus:{name:"hasmembership",value:0}}),h(f(t),"removePromotion",(function(){document.querySelectorAll("[id^=PlasmaPromotionWrapper]").forEach((function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})),n.destroyBanner(),n.promotionData=null,n.promotion=null,t.isBannerInit=!1})),h(f(t),"getPromotion",(function(e){var n=e.childNodes,o=n[0].querySelector("[class*=PlasmaPromotionJs]"),a=o&&o.getAttribute("data-name")||null;if(1===n.length)return t.bannerName=a,void t.runPromotion();t.bannerName&&a===t.bannerName?n[0].remove():((0,s.default)(r.BANNER_EVENTS.destroy),t.bannerName=a,n[1].remove(),t.runPromotion())})),h(f(t),"runPromotion",(function(){var e=setTimeout(d(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.promotion.run();case 2:n.promotionData=t.sent,clearTimeout(e);case 4:case"end":return t.stop()}}),t)}))),1e3)})),t.isBannerScriptLoaded=!1,t.isBannerInit=!1,t.bannerName="",!n.promotionData||n.promotionData.args.locale!==e.locale){t.bannerZones.push({id:i.default.revive.zoneId,wrapper:`${i.default.plasmaPromotionClass}${i.default.revive.zoneId}`,zone:`<div class="js-revive-banner-container"><ins data-revive-zoneid="${i.default.revive.zoneId}" data-revive-id="${i.default.revive.hash}"></ins></div>`});var u=e.locale,l=e.location.pathname;if(!n.detectPageWithoutBanner(l))try{t.initBanners(u)}catch(e){}}return t}var t,o,u;return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&v(e,n)}(n,e),t=n,(o=[{key:"componentDidUpdate",value:function(e){var t=this.props,o=t.locale,r=t.location.pathname,a=n.detectPageWithoutBanner(r);(a||!a&&e.locale!==o)&&this.removePromotion(),a||this.isBannerInit||n.promotionData&&e.location.pathname===r&&e.locale===o||(this.initBanners(o),this.isBannerInit=!0)}},{key:"addBannerAttribute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.bannerAttributes[e]=n}},{key:"removeBannerAttribute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";void 0!==this.bannerAttributes&&void 0!==this.bannerAttributes[e]&&delete this.bannerAttributes[e]}},{key:"initBanners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.bannerZones.length)return!1;window.reviveAsync={};var o=String(Date.now()).valueOf();this.addBannerAttribute("locale",{name:"locale",value:t||this.props.locale}),n.promotion=new a.default,this.bannerZones.forEach((function(n){var t=document.getElementById(`PlasmaPromotionWrapper-${i.default.revive.zoneId}`);if(null===t||t.length<1)return!1;var r=document.createElement("script"),a=(new DOMParser).parseFromString(n.zone,"text/html").body.childNodes[0],u=a.querySelector("ins");for(var s in e.bannerAttributes){var l=e.bannerAttributes[s];l.value=String(l.value).valueOf(),u.setAttribute(`data-revive-${l.name}`,l.value)}a.querySelector("ins").remove(),a.insertBefore(u,a.firstChild),t.insertBefore(a,t.firstChild),r.src=`${e.initJsUrl}?${o}`,r.id="promotion_initiator",r.async=!0,r.onerror=function(){throw new Error("Banner insert script is lost")},document.body.lastChild.parentElement.append(r),e.isBannerScriptLoaded||(document.documentElement.addEventListener("bannerScriptLoadEvent",(function(){e.getPromotion(t)})),e.isBannerScriptLoaded=!0)}))}},{key:"componentWillUnmount",value:function(){n.promotionData=null,n.promotion=null}},{key:"render",value:function(){return b(P,null)}}])&&m(t.prototype,o),u&&m(t,u),n}(y);h(g,"promotionData",null),h(g,"promotion",null),h(g,"hideBanner",(function(){g.promotionData&&g.promotionData.banner&&g.promotionData.banner.hideBanner()})),h(g,"destroyBanner",(function(){g.promotionData&&g.promotionData.banner&&g.promotionData.banner.destroyBanner()})),h(g,"detectPageWithoutBanner",(function(e){return(0,u.isDemoPage)(e)||(0,u.isCartPage)(e)||(0,u.isCollectionPage)(e)})),n.default=g},"./src/shared/components/Promotions/index.js":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var o,r=t("./node_modules/react-router-dom/es/index.js"),a=t("./src/shared/components/LocaleContext/index.jsx"),i=t("./src/shared/components/Promotions/Promotions.jsx"),u=(o=i)&&o.__esModule?o:{default:o};n.default=(0,r.withRouter)((0,a.withLocale)(u.default))}}]);